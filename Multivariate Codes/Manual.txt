1. First source Faster_LOOCV_Rcpp.cpp

2. Then source MCSampleRcpp.cpp

3. Then source the R files: Mult_LOOCV_Rcpp.R (dependent on Faster_LOOCV_Rcpp) and MultivariateNNDP_Stock.R (dependent on MCSampleRcpp). This loads all the functions.

4. First learn optimal value of \phi_{0}^{2} using the leave one out cross validation functions, then define \psi_{0} to be the diagonal matrix of dimension p with entries \gamma_{0}*\phi_{0}^{2} and run the stock Multivariate NNDP function.

Note: The LOOCV file requires a phi0seq (usually the sequence seq(0.01,2,length.out=40)) and a fixed value of \gamma_{0}. An example simulation code is given in the Multivariate_Hyperparameters.R code.

Recommendations:

1. Take gamma_{0} = (p-1)+1 - equivalent to specifying a prior predictive density of Multivariate Cauchy (heavy tailed). Can also try \gamma_{0} = (p-1) + \delta for some small \delta > 0, a noninformative choice of the degrees of freedom.
2. Learn phi_{0}^2 using leave one out cross validation with this fixed choice of gamma_{0}. 
3. Finally take psi0 = diag((gamma_{0}-p+1)*phi_{0}^2) - matches with marginal estimation.